---
title: " ğŸ“ˆ æ±è¨¼ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰å¸‚å ´åˆ†æ"
author: Karuni
date: today
format: 
  html:
    toc: true
    number-sections: true
---
```{r}
library(tidyverse)
library(gt)

##ãƒ‡ãƒ¼ã‚¿
df <- read_csv("data/1376_financial.csv")

##åˆ—åå¤‰æ›´ã€€è¡¨å‡ºåŠ›
df|>
  gt() |> 
  sub_missing(columns = everything(), missing_text = "") |> 
  cols_label(`Unnamed: 0_bs` = "Year",
             `Treasury Shares Number_bs` = "è‡ªå·±æ ªå¼ã®æ•°",  
             `Ordinary Shares Number_bs` = "æ™®é€šæ ªå¼ã®æ•°",  
             `Share Issued_bs` = "ç™ºè¡Œæ¸ˆã¿æ ªå¼ã®æ•°",  
             `Tangible Book Value_bs` = "æœ‰å½¢ã®å¸³ç°¿ä¾¡å€¤",  
             `Invested Capital_bs` = "æŠ•è³‡è³‡æœ¬",  
             `Working Capital_bs` = "é‹è»¢è³‡æœ¬",  
             `Net Tangible Assets_bs` = "ç´”æœ‰å½¢è³‡ç”£",  
             `Common Stock Equity_bs` = "æ™®é€šæ ªå¼è³‡æœ¬",  
             `Total Capitalization_bs` = "ç·è³‡æœ¬",  
             `Total Equity Gross Minority Interest_bs` = "ç·è³‡æœ¬ï¼ˆå°‘æ•°æ ªä¸»æŒåˆ†ã‚’å«ã‚€ï¼‰",  
             `Minority Interest_bs` = "å°‘æ•°æ ªä¸»æŒåˆ†",  
             `Stockholders Equity_bs` = "æ ªä¸»è³‡æœ¬",  
             `Treasury Stock_bs` = "è‡ªå·±æ ªå¼",  
             `Retained Earnings_bs` = "ç•™ä¿åˆ©ç›Š",  
             `Additional Paid In Capital_bs` = "è¿½åŠ æ‰•è¾¼è³‡æœ¬",  
             `Capital Stock_bs` = "è³‡æœ¬æ ªå¼",  
             `Common Stock_bs` = "æ™®é€šæ ªå¼",  
             `Total Liabilities Net Minority Interest_bs` = "ç·è² å‚µï¼ˆå°‘æ•°æ ªä¸»æŒåˆ†ã‚’é™¤ãï¼‰",  
             `Total Non Current Liabilities Net Minority Interest_bs` = "ç·éæµå‹•è² å‚µï¼ˆå°‘æ•°æ ªä¸»æŒåˆ†ã‚’é™¤ãï¼‰",  
             `Other Non Current Liabilities_bs` = "ãã®ä»–ã®éæµå‹•è² å‚µ",  
             `Non Current Pension And Other Postretirement Benefit Plans_bs` = "éæµå‹•å¹´é‡‘ãŠã‚ˆã³ãã®ä»–ã®é€€è·å¾Œçµ¦ä»˜ãƒ—ãƒ©ãƒ³",  
             `Current Liabilities_bs` = "æµå‹•è² å‚µ",  
             `Other Current Liabilities_bs` = "ãã®ä»–ã®æµå‹•è² å‚µ",  
             `Payables_bs` = "æ”¯æ‰•å‚µå‹™",  
             `Total Tax Payable_bs` = "æ”¯æ‰•ã†ã¹ãç·ç¨é‡‘",  
             `Accounts Payable_bs` = "è²·æ›é‡‘",  
             `Total Assets_bs` = "ç·è³‡ç”£",  
             `Total Non Current Assets_bs` = "ç·éæµå‹•è³‡ç”£",  
             `Other Non Current Assets_bs` = "ãã®ä»–ã®éæµå‹•è³‡ç”£",  
             `Non Current Deferred Taxes Assets_bs` = "éæµå‹•ç¹°å»¶ç¨é‡‘è³‡ç”£",  
             `Investmentin Financial Assets_bs` = "é‡‘èè³‡ç”£ã¸ã®æŠ•è³‡",  
             `Available For Sale Securities_bs` = "å£²å´å¯èƒ½è¨¼åˆ¸",  
             `Goodwill And Other Intangible Assets_bs` = "ã®ã‚Œã‚“ãŠã‚ˆã³ãã®ä»–ã®ç„¡å½¢è³‡ç”£",  
             `Net PPE_bs` = "ç´”æœ‰å½¢å›ºå®šè³‡ç”£",  
             `Gross PPE_bs` = "ç·æœ‰å½¢å›ºå®šè³‡ç”£",  
             `Other Properties_bs` = "ãã®ä»–ã®ä¸å‹•ç”£",  
             `Buildings And Improvements_bs` = "å»ºç‰©ãŠã‚ˆã³ãã®æ”¹è‰¯",  
             `Land And Improvements_bs` = "åœŸåœ°ãŠã‚ˆã³ãã®æ”¹è‰¯",  
             `Properties_bs` = "ä¸å‹•ç”£",  
             `Current Assets_bs` = "æµå‹•è³‡ç”£",  
             `Other Current Assets_bs` = "ãã®ä»–ã®æµå‹•è³‡ç”£",  
             `Inventory_bs` = "åœ¨åº«",  
             `Finished Goods_bs` = "å®Œæˆå“",  
             `Other Receivables_bs` = "ãã®ä»–ã®å—å–å‚µæ¨©",  
             `Accounts Receivable_bs` = "å£²æ›é‡‘",  
             `Gross Accounts Receivable_bs` = "ç·å£²æ›é‡‘",  
             `Cash Cash Equivalents And Short Term Investments_bs` = "ç¾é‡‘ã€ç¾é‡‘åŒç­‰ç‰©ãŠã‚ˆã³çŸ­æœŸæŠ•è³‡",  
             `Cash And Cash Equivalents_bs` = "ç¾é‡‘ãŠã‚ˆã³ç¾é‡‘åŒç­‰ç‰©",  
             `ticker` = "ãƒ†ã‚£ãƒƒã‚«ãƒ¼",  
             `Unnamed: 0_is` = "Year1",  
             `Tax Effect Of Unusual Items_is` = "ç•°å¸¸é …ç›®ã®ç¨åŠ¹æœ",  
             `Tax Rate For Calcs_is` = "è¨ˆç®—ç”¨ç¨ç‡",  
             `Normalized EBITDA_is` = "æ­£è¦åŒ–EBITDA",  
             `Total Unusual Items_is` = "ç•°å¸¸é …ç›®åˆè¨ˆ",  
             `Total Unusual Items Excluding Goodwill_is` = "ã®ã‚Œã‚“ã‚’é™¤ãç•°å¸¸é …ç›®åˆè¨ˆ",  
             `Net Income From Continuing Operation Net Minority Interest_is` = "ç¶™ç¶šäº‹æ¥­ã‹ã‚‰ã®ç´”åˆ©ç›Šï¼ˆå°‘æ•°æ ªä¸»æŒåˆ†ã‚’é™¤ãï¼‰",  
             `Reconciled Depreciation_is` = "ä¿®æ­£å¾Œã®æ¸›ä¾¡å„Ÿå´",  
             `Reconciled Cost Of Revenue_is` = "ä¿®æ­£å¾Œã®åç›ŠåŸä¾¡",  
             `EBITDA_is` = "EBITDA",  
             `EBIT_is` = "EBIT",  
             `Net Interest Income_is` = "ç´”åˆ©æ¯åå…¥",  
             `Interest Expense_is` = "åˆ©æ¯è²»ç”¨",  
             `Interest Income_is` = "åˆ©æ¯åå…¥",  
             `Normalized Income_is` = "æ­£è¦åŒ–åå…¥",  
             `Net Income From Continuing And Discontinued Operation_is` = "ç¶™ç¶šäº‹æ¥­ãŠã‚ˆã³ä¸­æ­¢äº‹æ¥­ã‹ã‚‰ã®ç´”åˆ©ç›Š",  
             `Total Expenses_is` = "ç·è²»ç”¨",  
             `Total Operating Income As Reported_is` = "å ±å‘Šã•ã‚ŒãŸç·å–¶æ¥­åˆ©ç›Š",  
             `Diluted Average Shares_is` = "å¸Œè–„åŒ–å¾Œå¹³å‡æ ªå¼æ•°",  
             `Basic Average Shares_is` = "åŸºæœ¬å¹³å‡æ ªå¼æ•°",  
             `Diluted EPS_is` = "å¸Œè–„åŒ–å¾ŒEPS",  
             `Basic EPS_is` = "åŸºæœ¬EPS",  
             `Diluted NI Availto Com Stockholders_is` = "å¸Œè–„åŒ–å¾Œç´”åˆ©ç›Šï¼ˆæ™®é€šæ ªä¸»ã«åˆ©ç”¨å¯èƒ½ï¼‰",  
             `Net Income Common Stockholders_is` = "ç´”åˆ©ç›Šï¼ˆæ™®é€šæ ªä¸»ï¼‰",  
             `Otherunder Preferred Stock Dividend_is` = "å„ªå…ˆæ ªé…å½“ã®ãã®ä»–",  
             `Net Income_is` = "ç´”åˆ©ç›Š",  
             `Minority Interests_is` = "å°‘æ•°æ ªä¸»æŒåˆ†",  
             `Net Income Including Noncontrolling Interests_is` = "éæ”¯é…æŒåˆ†ã‚’å«ã‚€ç´”åˆ©ç›Š",  
             `Net Income Continuous Operations_is` = "ç¶™ç¶šäº‹æ¥­ã‹ã‚‰ã®ç´”åˆ©ç›Š",  
             `Tax Provision_is` = "ç¨é‡‘å¼•å½“é‡‘",  
             `Pretax Income_is` = "ç¨å¼•å‰åˆ©ç›Š",  
             `Other Non Operating Income Expenses_is` = "ãã®ä»–ã®éå–¶æ¥­åå…¥è²»ç”¨",  
             `Special Income Charges_is` = "ç‰¹åˆ¥åå…¥é …ç›®",  
             `Other Special Charges_is` = "ãã®ä»–ã®ç‰¹åˆ¥è²»ç”¨",  
             `Write Off_is` = "è²»ç”¨å‡¦ç†",  
             `Net Non Operating Interest Income Expense_is` = "ç´”éå–¶æ¥­åˆ©æ¯åå…¥è²»ç”¨",  
             `Interest Expense Non Operating_is` = "éå–¶æ¥­åˆ©æ¯è²»ç”¨",  
             `Interest Income Non Operating_is` = "éå–¶æ¥­åˆ©æ¯åå…¥",  
             `Operating Income_is` = "å–¶æ¥­åˆ©ç›Š",  
             `Operating Expense_is` = "å–¶æ¥­è²»ç”¨",  
             `Gross Profit_is` = "ç·åˆ©ç›Š",  
             `Cost Of Revenue_is` = "åç›ŠåŸä¾¡",  
             `Total Revenue_is` = "ç·åç›Š",  
             `Operating Revenue_is` = "å–¶æ¥­åç›Š",  
             `Unnamed: 0_cf` = "Year2",  
             `Free Cash Flow_cf` = "ãƒ•ãƒªãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼",  
             `Repurchase Of Capital Stock_cf` = "è‡ªå·±æ ªå¼ã®å†å–å¾—",  
             `Repayment Of Debt_cf` = "å€Ÿå…¥é‡‘è¿”æ¸ˆ",  
             `Issuance Of Debt_cf` = "å€Ÿå…¥é‡‘ç™ºè¡Œ",  
             `Capital Expenditure_cf` = "è¨­å‚™æŠ•è³‡",  
             `End Cash Position_cf` = "æœŸæœ«ç¾é‡‘æ®‹é«˜",  
             `Other Cash Adjustment Outside Changein Cash_cf` = "ç¾é‡‘ä»¥å¤–ã®ãã®ä»–ã®ç¾é‡‘èª¿æ•´",  
             `Beginning Cash Position_cf` = "æœŸé¦–ç¾é‡‘æ®‹é«˜",  
             `Effect Of Exchange Rate Changes_cf` = "ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆå¤‰å‹•ã®å½±éŸ¿",  
             `Changes In Cash_cf` = "ç¾é‡‘ã®å¤‰å‹•",  
             `Financing Cash Flow_cf` = "è²¡å‹™ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼",  
             `Net Other Financing Charges_cf` = "ç´”ãã®ä»–ã®è²¡å‹™è²»ç”¨",  
             `Cash Dividends Paid_cf` = "ç¾é‡‘é…å½“æ”¯æ‰•ã„",  
             `Common Stock Dividend Paid_cf` = "æ™®é€šæ ªå¼é…å½“æ”¯æ‰•ã„",  
             `Net Common Stock Issuance_cf` = "æ™®é€šæ ªå¼ç™ºè¡Œç´”é¡",  
             `Common Stock Payments_cf` = "æ™®é€šæ ªå¼æ”¯æ‰•ã„",  
             `Net Issuance Payments Of Debt_cf` = "å€Ÿå…¥é‡‘ç™ºè¡Œã®ç´”æ”¯æ‰•ã„",  
             `Net Short Term Debt Issuance_cf` = "çŸ­æœŸå€Ÿå…¥é‡‘ç™ºè¡Œã®ç´”é¡",  
             `Short Term Debt Payments_cf` = "çŸ­æœŸå€Ÿå…¥é‡‘æ”¯æ‰•ã„",  
             `Short Term Debt Issuance_cf` = "çŸ­æœŸå€Ÿå…¥é‡‘ç™ºè¡Œ",  
             `Investing Cash Flow_cf` = "æŠ•è³‡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼",  
             `Net Other Investing Changes_cf` = "ç´”ãã®ä»–ã®æŠ•è³‡å¤‰å‹•",  
             `Net Investment Purchase And Sale_cf` = "æŠ•è³‡ã®è³¼å…¥ãŠã‚ˆã³å£²å´ã®ç´”é¡",  
             `Sale Of Investment_cf` = "æŠ•è³‡ã®å£²å´",  
             `Purchase Of Investment_cf` = "æŠ•è³‡ã®è³¼å…¥",  
             `Net Intangibles Purchase And Sale_cf` = "ç„¡å½¢è³‡ç”£ã®è³¼å…¥ãŠã‚ˆã³å£²å´ã®ç´”é¡",  
             `Purchase Of Intangibles_cf` = "ç„¡å½¢è³‡ç”£ã®è³¼å…¥",  
             `Net PPE Purchase And Sale_cf` = "æœ‰å½¢å›ºå®šè³‡ç”£ã®è³¼å…¥ãŠã‚ˆã³å£²å´ã®ç´”é¡",  
             `Sale Of PPE_cf` = "æœ‰å½¢å›ºå®šè³‡ç”£ã®å£²å´",  
             `Purchase Of PPE_cf` = "æœ‰å½¢å›ºå®šè³‡ç”£ã®è³¼å…¥",  
             `Operating Cash Flow_cf` = "å–¶æ¥­ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼",  
             `Taxes Refund Paid_cf` = "ç¨é‡‘é‚„ä»˜æ”¯æ‰•ã„",  
             `Interest Received Cfo_cf` = "CFOã‹ã‚‰ã®åˆ©æ¯å—å–",  
             `Interest Paid Cfo_cf` = "CFOã¸ã®åˆ©æ¯æ”¯æ‰•ã„",  
             `Change In Working Capital_cf` = "é‹è»¢è³‡æœ¬ã®å¤‰å‹•",  
             `Change In Other Current Assets_cf` = "ãã®ä»–ã®æµå‹•è³‡ç”£ã®å¤‰å‹•",  
             `Change In Payable_cf` = "æ”¯æ‰•å‚µå‹™ã®å¤‰å‹•",  
             `Change In Inventory_cf` = "åœ¨åº«ã®å¤‰å‹•",  
             `Change In Receivables_cf` = "å£²æ›é‡‘ã®å¤‰å‹•",  
             `Other Non Cash Items_cf` = "ãã®ä»–ã®éç¾é‡‘é …ç›®",  
             `Depreciation And Amortization_cf` = "æ¸›ä¾¡å„Ÿå´ãŠã‚ˆã³å„Ÿå´",  
             `Depreciation_cf` = "æ¸›ä¾¡å„Ÿå´",  
             `Gain Loss On Investment Securities_cf` = "æŠ•è³‡è¨¼åˆ¸ã®æç›Š",  
             `Gain Loss On Sale Of PPE_cf` = "æœ‰å½¢å›ºå®šè³‡ç”£ã®å£²å´æç›Š",  
             `Net Income From Continuing Operations_cf` = "ç¶™ç¶šäº‹æ¥­ã‹ã‚‰ã®ç´”åˆ©ç›Š",  
             `Stock_Price` = "æ ªä¾¡",  
  )
    

PL_df <- df |> 
  select(`Unnamed: 0_bs`, `Total Revenue_is`, `Operating Income_is`, `Net Income_is`)

PL_df_lo <- PL_df |> 
  pivot_longer(cols = -`Unnamed: 0_bs`,
               names_to =  "åˆ©ç›Š",
               values_to = "é‡‘é¡")

#PL_df_loã®åˆ—åå¤‰æ›´ã€NAæ¶ˆå»ç­‰
PL_df_lo <- rename(PL_df_lo, Year=`Unnamed: 0_bs`)
PL_df_lo <- PL_df_lo |> 
  filter(!is.na(Year))

PL_df_lo <- PL_df_lo |> 
  mutate(Year = substr(Year,1,4))

PL_df_lo <- PL_df_lo |> 
  mutate(åˆ©ç›Š = recode(åˆ©ç›Š,
                     "Total Revenue_is" = "å£²ä¸Šé«˜",
                     "Operating Income_is" = "å–¶æ¥­åˆ©ç›Š",
                     "Net Income_is" = "ç´”åˆ©ç›Š"))

PL_df_lo |> 
  ggplot(aes(x = Year, y = é‡‘é¡ , fill = åˆ©ç›Š)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "å£²ä¸Šé«˜ãƒ»å–¶æ¥­åˆ©ç›Šãƒ»ç´”åˆ©ç›Šã®æ¨ç§»",
       x = "å¹´åº¦",
       y = "é‡‘é¡",
       fill = "åˆ©ç›Š") +
  theme_minimal()


```